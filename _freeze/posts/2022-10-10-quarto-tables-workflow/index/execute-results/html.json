{
  "hash": "fdbb4b97295b7c8db7c60b12fdab2f06",
  "result": {
    "markdown": "---\ntitle: \"My Approach to Tables in Quarto Documents\"\ndate: 2022-10-10\nformat: \n  html:\n    code-fold: show\ncategories: [quarto, rmarkdown, knitr, kableExtra, flextable]\n---\n\n\nWhenever possible I try to use graphs and plots to back up my story\n  about data analysis. That said, sometimes you've just got use some\n  data tables. That could be summary statistics, regression/ANOVA tables,\n  or maybe wedding the visual aids by creating sparklines or mini-plots\n  within a table. \n  \nIn 2022 there are no shortage of R libraries for making beautiful graphs\n  and tables, but my most commonly used tools right now are kableExtra\n  and flextable. gt looks promising but it's still fairly new. I've \n  tried using huxtable but for whatever reason it's never quite clicked\n  with me. DT is a great library but I try to avoid it for rmarkdown/quarto\n  documents due to how large it blows up HTML files. It's great when I\n  need to include a full dataset in a report though, or in Shiny apps.\n  \n## HTML Tables\n\nI am unaware of any pdf-exclusive r table libraries, but that doesn't mean they\n  don't exist. All of the previously mentioned tables can produce HTML tables,\n  but I really only use:\n  \n1. kableExtra\n2. flextable\n3. DT\n\nmostly in that order.\n\n\n::: {.cell}\n\n```{.r .cell-code}\nlibrary(dplyr)\n```\n:::\n\n\n\n### kableExtra\n\nkableExtra is my go-to for HTML tables in my documents. I think the default \n  settings look pretty good, and it's easy to tweak them to get exactly what I\n  want. \n\n\n::: {.cell tbl-cap='Iris Data - kableExtra'}\n\n```{.r .cell-code}\niris |> \n  group_by(Species) |> \n  summarise(across(.fns=list(mean=mean, sd=sd))) |> \n  kableExtra::kbl(\n    col.names = c(\"Species\", rep(c(\"Mean\", \"SD\"), 4)),\n    digits=1\n  ) |> \n  kableExtra::add_header_above(\n    c(\" \", \n      \"Sepal Length\"=2, \n      \"Sepal Width\"=2,\n      \"Petal Length\"=2,\n      \"Petal Width\"=2), \n    align = \"c\"\n  ) |> \n  kableExtra::kable_styling(\n    bootstrap_options = c(\"hover\", \"responsive\")\n  )\n```\n\n::: {.cell-output-display}\n`````{=html}\n<table class=\"table table-hover table-responsive\" style=\"margin-left: auto; margin-right: auto;\">\n <thead>\n<tr>\n<th style=\"empty-cells: hide;border-bottom:hidden;\" colspan=\"1\"></th>\n<th style=\"border-bottom:hidden;padding-bottom:0; padding-left:3px;padding-right:3px;text-align: center; \" colspan=\"2\"><div style=\"border-bottom: 1px solid #ddd; padding-bottom: 5px; \">Sepal Length</div></th>\n<th style=\"border-bottom:hidden;padding-bottom:0; padding-left:3px;padding-right:3px;text-align: center; \" colspan=\"2\"><div style=\"border-bottom: 1px solid #ddd; padding-bottom: 5px; \">Sepal Width</div></th>\n<th style=\"border-bottom:hidden;padding-bottom:0; padding-left:3px;padding-right:3px;text-align: center; \" colspan=\"2\"><div style=\"border-bottom: 1px solid #ddd; padding-bottom: 5px; \">Petal Length</div></th>\n<th style=\"border-bottom:hidden;padding-bottom:0; padding-left:3px;padding-right:3px;text-align: center; \" colspan=\"2\"><div style=\"border-bottom: 1px solid #ddd; padding-bottom: 5px; \">Petal Width</div></th>\n</tr>\n  <tr>\n   <th style=\"text-align:left;\"> Species </th>\n   <th style=\"text-align:right;\"> Mean </th>\n   <th style=\"text-align:right;\"> SD </th>\n   <th style=\"text-align:right;\"> Mean </th>\n   <th style=\"text-align:right;\"> SD </th>\n   <th style=\"text-align:right;\"> Mean </th>\n   <th style=\"text-align:right;\"> SD </th>\n   <th style=\"text-align:right;\"> Mean </th>\n   <th style=\"text-align:right;\"> SD </th>\n  </tr>\n </thead>\n<tbody>\n  <tr>\n   <td style=\"text-align:left;\"> setosa </td>\n   <td style=\"text-align:right;\"> 5.0 </td>\n   <td style=\"text-align:right;\"> 0.4 </td>\n   <td style=\"text-align:right;\"> 3.4 </td>\n   <td style=\"text-align:right;\"> 0.4 </td>\n   <td style=\"text-align:right;\"> 1.5 </td>\n   <td style=\"text-align:right;\"> 0.2 </td>\n   <td style=\"text-align:right;\"> 0.2 </td>\n   <td style=\"text-align:right;\"> 0.1 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;\"> versicolor </td>\n   <td style=\"text-align:right;\"> 5.9 </td>\n   <td style=\"text-align:right;\"> 0.5 </td>\n   <td style=\"text-align:right;\"> 2.8 </td>\n   <td style=\"text-align:right;\"> 0.3 </td>\n   <td style=\"text-align:right;\"> 4.3 </td>\n   <td style=\"text-align:right;\"> 0.5 </td>\n   <td style=\"text-align:right;\"> 1.3 </td>\n   <td style=\"text-align:right;\"> 0.2 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;\"> virginica </td>\n   <td style=\"text-align:right;\"> 6.6 </td>\n   <td style=\"text-align:right;\"> 0.6 </td>\n   <td style=\"text-align:right;\"> 3.0 </td>\n   <td style=\"text-align:right;\"> 0.3 </td>\n   <td style=\"text-align:right;\"> 5.6 </td>\n   <td style=\"text-align:right;\"> 0.6 </td>\n   <td style=\"text-align:right;\"> 2.0 </td>\n   <td style=\"text-align:right;\"> 0.3 </td>\n  </tr>\n</tbody>\n</table>\n\n`````\n:::\n:::\n\n\nIt's pretty easy to get a nice-looking table, and I really like the \"hover\"\n  and \"responsive\" bootstrap options in `kableExtra::kable_styling()`. Hover\n  gives a quasi-interactive feel to the table, without having to load all the \n  javascript required for sorting, filtering, etc. `DT` is better suited for\n  that level of interactivity, but most tables probably don't need that. \n  \n### flextable\n\nFlextable also makes pretty nice HTML tables, but they are more static than \n  kableExtra's.\n  \n\n::: {.cell tbl-cap='Iris data - flextable'}\n\n```{.r .cell-code}\niris |> \n  group_by(Species) |> \n  summarise(across(.fns=list(mean=mean, sd=sd))) |> \n  flextable::flextable() |> \n  flextable::set_header_labels(\n    Sepal.Length_mean = \"Mean\",\n    Sepal.Length_sd = \"SD\",\n    Sepal.Width_mean = \"Mean\",\n    Sepal.Width_sd = \"SD\",\n    Petal.Length_mean = \"Mean\",\n    Petal.Length_sd = \"SD\",\n    Petal.Width_mean = \"Mean\",\n    Petal.Width_sd = \"SD\"\n  ) |> \n  flextable::add_header_row(\n    values=c(\"\", \"Sepal Length\", \"Sepal Width\", \"Petal Length\", \"Petal Width\"),\n    colwidths = c(1, 2, 2, 2, 2)\n  ) |> \n  flextable::colformat_double(j=2:9, digits=1) |> \n  flextable::align(i=1, j=2:9, align=\"center\", part=\"header\")\n```\n\n::: {.cell-output-display}\n```{=html}\n<div class=\"tabwid\"><style>.cl-e270a5dc{}.cl-e2550890{font-family:'Arial';font-size:11pt;font-weight:normal;font-style:normal;text-decoration:none;color:rgba(0, 0, 0, 1.00);background-color:transparent;}.cl-e25fc94c{margin:0;text-align:left;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);padding-bottom:5pt;padding-top:5pt;padding-left:5pt;padding-right:5pt;line-height: 1;background-color:transparent;}.cl-e25fc960{margin:0;text-align:center;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);padding-bottom:5pt;padding-top:5pt;padding-left:5pt;padding-right:5pt;line-height: 1;background-color:transparent;}.cl-e25fc96a{margin:0;text-align:right;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);padding-bottom:5pt;padding-top:5pt;padding-left:5pt;padding-right:5pt;line-height: 1;background-color:transparent;}.cl-e26034cc{width:0.75in;background-color:transparent;vertical-align: middle;border-bottom: 2pt solid rgba(102, 102, 102, 1.00);border-top: 2pt solid rgba(102, 102, 102, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-e26034e0{width:0.75in;background-color:transparent;vertical-align: middle;border-bottom: 2pt solid rgba(102, 102, 102, 1.00);border-top: 2pt solid rgba(102, 102, 102, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-e26034e1{width:0.75in;background-color:transparent;vertical-align: middle;border-bottom: 2pt solid rgba(102, 102, 102, 1.00);border-top: 2pt solid rgba(102, 102, 102, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-e26034ea{width:0.75in;background-color:transparent;vertical-align: middle;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-e26034f4{width:0.75in;background-color:transparent;vertical-align: middle;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-e26034f5{width:0.75in;background-color:transparent;vertical-align: middle;border-bottom: 2pt solid rgba(102, 102, 102, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-e26034fe{width:0.75in;background-color:transparent;vertical-align: middle;border-bottom: 2pt solid rgba(102, 102, 102, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}</style><table class='cl-e270a5dc'><caption></caption><thead><tr style=\"overflow-wrap:break-word;\"><th class=\"cl-e26034cc\"><p class=\"cl-e25fc94c\"><span class=\"cl-e2550890\"></span></p></th><th  colspan=\"2\"class=\"cl-e26034e0\"><p class=\"cl-e25fc960\"><span class=\"cl-e2550890\">Sepal Length</span></p></th><th  colspan=\"2\"class=\"cl-e26034e0\"><p class=\"cl-e25fc960\"><span class=\"cl-e2550890\">Sepal Width</span></p></th><th  colspan=\"2\"class=\"cl-e26034e0\"><p class=\"cl-e25fc960\"><span class=\"cl-e2550890\">Petal Length</span></p></th><th  colspan=\"2\"class=\"cl-e26034e0\"><p class=\"cl-e25fc960\"><span class=\"cl-e2550890\">Petal Width</span></p></th></tr><tr style=\"overflow-wrap:break-word;\"><th class=\"cl-e26034cc\"><p class=\"cl-e25fc94c\"><span class=\"cl-e2550890\">Species</span></p></th><th class=\"cl-e26034e1\"><p class=\"cl-e25fc96a\"><span class=\"cl-e2550890\">Mean</span></p></th><th class=\"cl-e26034e1\"><p class=\"cl-e25fc96a\"><span class=\"cl-e2550890\">SD</span></p></th><th class=\"cl-e26034e1\"><p class=\"cl-e25fc96a\"><span class=\"cl-e2550890\">Mean</span></p></th><th class=\"cl-e26034e1\"><p class=\"cl-e25fc96a\"><span class=\"cl-e2550890\">SD</span></p></th><th class=\"cl-e26034e1\"><p class=\"cl-e25fc96a\"><span class=\"cl-e2550890\">Mean</span></p></th><th class=\"cl-e26034e1\"><p class=\"cl-e25fc96a\"><span class=\"cl-e2550890\">SD</span></p></th><th class=\"cl-e26034e1\"><p class=\"cl-e25fc96a\"><span class=\"cl-e2550890\">Mean</span></p></th><th class=\"cl-e26034e1\"><p class=\"cl-e25fc96a\"><span class=\"cl-e2550890\">SD</span></p></th></tr></thead><tbody><tr style=\"overflow-wrap:break-word;\"><td class=\"cl-e26034ea\"><p class=\"cl-e25fc94c\"><span class=\"cl-e2550890\">setosa</span></p></td><td class=\"cl-e26034f4\"><p class=\"cl-e25fc96a\"><span class=\"cl-e2550890\">5.0</span></p></td><td class=\"cl-e26034f4\"><p class=\"cl-e25fc96a\"><span class=\"cl-e2550890\">0.4</span></p></td><td class=\"cl-e26034f4\"><p class=\"cl-e25fc96a\"><span class=\"cl-e2550890\">3.4</span></p></td><td class=\"cl-e26034f4\"><p class=\"cl-e25fc96a\"><span class=\"cl-e2550890\">0.4</span></p></td><td class=\"cl-e26034f4\"><p class=\"cl-e25fc96a\"><span class=\"cl-e2550890\">1.5</span></p></td><td class=\"cl-e26034f4\"><p class=\"cl-e25fc96a\"><span class=\"cl-e2550890\">0.2</span></p></td><td class=\"cl-e26034f4\"><p class=\"cl-e25fc96a\"><span class=\"cl-e2550890\">0.2</span></p></td><td class=\"cl-e26034f4\"><p class=\"cl-e25fc96a\"><span class=\"cl-e2550890\">0.1</span></p></td></tr><tr style=\"overflow-wrap:break-word;\"><td class=\"cl-e26034ea\"><p class=\"cl-e25fc94c\"><span class=\"cl-e2550890\">versicolor</span></p></td><td class=\"cl-e26034f4\"><p class=\"cl-e25fc96a\"><span class=\"cl-e2550890\">5.9</span></p></td><td class=\"cl-e26034f4\"><p class=\"cl-e25fc96a\"><span class=\"cl-e2550890\">0.5</span></p></td><td class=\"cl-e26034f4\"><p class=\"cl-e25fc96a\"><span class=\"cl-e2550890\">2.8</span></p></td><td class=\"cl-e26034f4\"><p class=\"cl-e25fc96a\"><span class=\"cl-e2550890\">0.3</span></p></td><td class=\"cl-e26034f4\"><p class=\"cl-e25fc96a\"><span class=\"cl-e2550890\">4.3</span></p></td><td class=\"cl-e26034f4\"><p class=\"cl-e25fc96a\"><span class=\"cl-e2550890\">0.5</span></p></td><td class=\"cl-e26034f4\"><p class=\"cl-e25fc96a\"><span class=\"cl-e2550890\">1.3</span></p></td><td class=\"cl-e26034f4\"><p class=\"cl-e25fc96a\"><span class=\"cl-e2550890\">0.2</span></p></td></tr><tr style=\"overflow-wrap:break-word;\"><td class=\"cl-e26034f5\"><p class=\"cl-e25fc94c\"><span class=\"cl-e2550890\">virginica</span></p></td><td class=\"cl-e26034fe\"><p class=\"cl-e25fc96a\"><span class=\"cl-e2550890\">6.6</span></p></td><td class=\"cl-e26034fe\"><p class=\"cl-e25fc96a\"><span class=\"cl-e2550890\">0.6</span></p></td><td class=\"cl-e26034fe\"><p class=\"cl-e25fc96a\"><span class=\"cl-e2550890\">3.0</span></p></td><td class=\"cl-e26034fe\"><p class=\"cl-e25fc96a\"><span class=\"cl-e2550890\">0.3</span></p></td><td class=\"cl-e26034fe\"><p class=\"cl-e25fc96a\"><span class=\"cl-e2550890\">5.6</span></p></td><td class=\"cl-e26034fe\"><p class=\"cl-e25fc96a\"><span class=\"cl-e2550890\">0.6</span></p></td><td class=\"cl-e26034fe\"><p class=\"cl-e25fc96a\"><span class=\"cl-e2550890\">2.0</span></p></td><td class=\"cl-e26034fe\"><p class=\"cl-e25fc96a\"><span class=\"cl-e2550890\">0.3</span></p></td></tr></tbody></table></div>\n```\n:::\n:::\n\n  \n### Some differences\n\nOne of the big differences between the 2 packages is how you make changes. \n  kableExtra, being based on knitr, leans towards to original R paradigm\n  of a few functions with a lot of internal options, while flextable leans\n  more towards to modern approach of several small functions that have a few options\n  each. \n  Neither approach is better than the other. \n  With many small functions there are more commands that have to be remembered, \n  but they are usually named in a way that easily explains what they do, and they \n  are typically logicial to read and don't require memorizing (and maintaining!)\n  as much documentation. One drawback is having to nest all of those functions, \n  or store output to variables over and over, but pipe functions (`|>` or `%>%`)\n  have largely eliminate that problem. Now the only thing to watch for is \n  long strings of spaghetti code, but that's an issue regardless. \n  \n  \n### DT\n\nDT is where I turn to in Shiny, or when I need to include a dataset as a table,\n  but I try to avoid that.\n  \n\n::: {.cell tbl-cap='Iris data - DT'}\n\n```{.r .cell-code}\niris |> \n  DT::datatable(\n    caption = \"Iris data- DT\",\n    filter=\"top\") |> \n  DT::formatRound(1:4, digits = 1)\n```\n\n::: {.cell-output-display}\n```{=html}\n<div class=\"datatables html-widget html-fill-item-overflow-hidden html-fill-item\" id=\"htmlwidget-639f4fbb2a291953364b\" style=\"width:100%;height:auto;\"></div>\n<script type=\"application/json\" data-for=\"htmlwidget-639f4fbb2a291953364b\">{\"x\":{\"filter\":\"top\",\"vertical\":false,\"filterHTML\":\"<tr>\\n  <td><\\/td>\\n  <td data-type=\\\"number\\\" style=\\\"vertical-align: top;\\\">\\n    <div class=\\\"form-group has-feedback\\\" style=\\\"margin-bottom: auto;\\\">\\n      <input type=\\\"search\\\" placeholder=\\\"All\\\" class=\\\"form-control\\\" style=\\\"width: 100%;\\\"/>\\n      <span class=\\\"glyphicon glyphicon-remove-circle form-control-feedback\\\"><\\/span>\\n    <\\/div>\\n    <div style=\\\"display: none;position: absolute;width: 200px;opacity: 1\\\">\\n      <div data-min=\\\"4.3\\\" data-max=\\\"7.9\\\" data-scale=\\\"1\\\"><\\/div>\\n      <span style=\\\"float: left;\\\"><\\/span>\\n      <span style=\\\"float: right;\\\"><\\/span>\\n    <\\/div>\\n  <\\/td>\\n  <td data-type=\\\"number\\\" style=\\\"vertical-align: top;\\\">\\n    <div class=\\\"form-group has-feedback\\\" style=\\\"margin-bottom: auto;\\\">\\n      <input type=\\\"search\\\" placeholder=\\\"All\\\" class=\\\"form-control\\\" style=\\\"width: 100%;\\\"/>\\n      <span class=\\\"glyphicon glyphicon-remove-circle form-control-feedback\\\"><\\/span>\\n    <\\/div>\\n    <div style=\\\"display: none;position: absolute;width: 200px;opacity: 1\\\">\\n      <div data-min=\\\"2\\\" data-max=\\\"4.4\\\" data-scale=\\\"1\\\"><\\/div>\\n      <span style=\\\"float: left;\\\"><\\/span>\\n      <span style=\\\"float: right;\\\"><\\/span>\\n    <\\/div>\\n  <\\/td>\\n  <td data-type=\\\"number\\\" style=\\\"vertical-align: top;\\\">\\n    <div class=\\\"form-group has-feedback\\\" style=\\\"margin-bottom: auto;\\\">\\n      <input type=\\\"search\\\" placeholder=\\\"All\\\" class=\\\"form-control\\\" style=\\\"width: 100%;\\\"/>\\n      <span class=\\\"glyphicon glyphicon-remove-circle form-control-feedback\\\"><\\/span>\\n    <\\/div>\\n    <div style=\\\"display: none;position: absolute;width: 200px;opacity: 1\\\">\\n      <div data-min=\\\"1\\\" data-max=\\\"6.9\\\" data-scale=\\\"1\\\"><\\/div>\\n      <span style=\\\"float: left;\\\"><\\/span>\\n      <span style=\\\"float: right;\\\"><\\/span>\\n    <\\/div>\\n  <\\/td>\\n  <td data-type=\\\"number\\\" style=\\\"vertical-align: top;\\\">\\n    <div class=\\\"form-group has-feedback\\\" style=\\\"margin-bottom: auto;\\\">\\n      <input type=\\\"search\\\" placeholder=\\\"All\\\" class=\\\"form-control\\\" style=\\\"width: 100%;\\\"/>\\n      <span class=\\\"glyphicon glyphicon-remove-circle form-control-feedback\\\"><\\/span>\\n    <\\/div>\\n    <div style=\\\"display: none;position: absolute;width: 200px;opacity: 1\\\">\\n      <div data-min=\\\"0.1\\\" data-max=\\\"2.5\\\" data-scale=\\\"1\\\"><\\/div>\\n      <span style=\\\"float: left;\\\"><\\/span>\\n      <span style=\\\"float: right;\\\"><\\/span>\\n    <\\/div>\\n  <\\/td>\\n  <td data-type=\\\"factor\\\" style=\\\"vertical-align: top;\\\">\\n    <div class=\\\"form-group has-feedback\\\" style=\\\"margin-bottom: auto;\\\">\\n      <input type=\\\"search\\\" placeholder=\\\"All\\\" class=\\\"form-control\\\" style=\\\"width: 100%;\\\"/>\\n      <span class=\\\"glyphicon glyphicon-remove-circle form-control-feedback\\\"><\\/span>\\n    <\\/div>\\n    <div style=\\\"width: 100%; display: none;\\\">\\n      <select multiple=\\\"multiple\\\" style=\\\"width: 100%;\\\" data-options=\\\"[&quot;setosa&quot;,&quot;versicolor&quot;,&quot;virginica&quot;]\\\"><\\/select>\\n    <\\/div>\\n  <\\/td>\\n<\\/tr>\",\"caption\":\"<caption>Iris data- DT<\\/caption>\",\"data\":[[\"1\",\"2\",\"3\",\"4\",\"5\",\"6\",\"7\",\"8\",\"9\",\"10\",\"11\",\"12\",\"13\",\"14\",\"15\",\"16\",\"17\",\"18\",\"19\",\"20\",\"21\",\"22\",\"23\",\"24\",\"25\",\"26\",\"27\",\"28\",\"29\",\"30\",\"31\",\"32\",\"33\",\"34\",\"35\",\"36\",\"37\",\"38\",\"39\",\"40\",\"41\",\"42\",\"43\",\"44\",\"45\",\"46\",\"47\",\"48\",\"49\",\"50\",\"51\",\"52\",\"53\",\"54\",\"55\",\"56\",\"57\",\"58\",\"59\",\"60\",\"61\",\"62\",\"63\",\"64\",\"65\",\"66\",\"67\",\"68\",\"69\",\"70\",\"71\",\"72\",\"73\",\"74\",\"75\",\"76\",\"77\",\"78\",\"79\",\"80\",\"81\",\"82\",\"83\",\"84\",\"85\",\"86\",\"87\",\"88\",\"89\",\"90\",\"91\",\"92\",\"93\",\"94\",\"95\",\"96\",\"97\",\"98\",\"99\",\"100\",\"101\",\"102\",\"103\",\"104\",\"105\",\"106\",\"107\",\"108\",\"109\",\"110\",\"111\",\"112\",\"113\",\"114\",\"115\",\"116\",\"117\",\"118\",\"119\",\"120\",\"121\",\"122\",\"123\",\"124\",\"125\",\"126\",\"127\",\"128\",\"129\",\"130\",\"131\",\"132\",\"133\",\"134\",\"135\",\"136\",\"137\",\"138\",\"139\",\"140\",\"141\",\"142\",\"143\",\"144\",\"145\",\"146\",\"147\",\"148\",\"149\",\"150\"],[5.1,4.9,4.7,4.6,5,5.4,4.6,5,4.4,4.9,5.4,4.8,4.8,4.3,5.8,5.7,5.4,5.1,5.7,5.1,5.4,5.1,4.6,5.1,4.8,5,5,5.2,5.2,4.7,4.8,5.4,5.2,5.5,4.9,5,5.5,4.9,4.4,5.1,5,4.5,4.4,5,5.1,4.8,5.1,4.6,5.3,5,7,6.4,6.9,5.5,6.5,5.7,6.3,4.9,6.6,5.2,5,5.9,6,6.1,5.6,6.7,5.6,5.8,6.2,5.6,5.9,6.1,6.3,6.1,6.4,6.6,6.8,6.7,6,5.7,5.5,5.5,5.8,6,5.4,6,6.7,6.3,5.6,5.5,5.5,6.1,5.8,5,5.6,5.7,5.7,6.2,5.1,5.7,6.3,5.8,7.1,6.3,6.5,7.6,4.9,7.3,6.7,7.2,6.5,6.4,6.8,5.7,5.8,6.4,6.5,7.7,7.7,6,6.9,5.6,7.7,6.3,6.7,7.2,6.2,6.1,6.4,7.2,7.4,7.9,6.4,6.3,6.1,7.7,6.3,6.4,6,6.9,6.7,6.9,5.8,6.8,6.7,6.7,6.3,6.5,6.2,5.9],[3.5,3,3.2,3.1,3.6,3.9,3.4,3.4,2.9,3.1,3.7,3.4,3,3,4,4.4,3.9,3.5,3.8,3.8,3.4,3.7,3.6,3.3,3.4,3,3.4,3.5,3.4,3.2,3.1,3.4,4.1,4.2,3.1,3.2,3.5,3.6,3,3.4,3.5,2.3,3.2,3.5,3.8,3,3.8,3.2,3.7,3.3,3.2,3.2,3.1,2.3,2.8,2.8,3.3,2.4,2.9,2.7,2,3,2.2,2.9,2.9,3.1,3,2.7,2.2,2.5,3.2,2.8,2.5,2.8,2.9,3,2.8,3,2.9,2.6,2.4,2.4,2.7,2.7,3,3.4,3.1,2.3,3,2.5,2.6,3,2.6,2.3,2.7,3,2.9,2.9,2.5,2.8,3.3,2.7,3,2.9,3,3,2.5,2.9,2.5,3.6,3.2,2.7,3,2.5,2.8,3.2,3,3.8,2.6,2.2,3.2,2.8,2.8,2.7,3.3,3.2,2.8,3,2.8,3,2.8,3.8,2.8,2.8,2.6,3,3.4,3.1,3,3.1,3.1,3.1,2.7,3.2,3.3,3,2.5,3,3.4,3],[1.4,1.4,1.3,1.5,1.4,1.7,1.4,1.5,1.4,1.5,1.5,1.6,1.4,1.1,1.2,1.5,1.3,1.4,1.7,1.5,1.7,1.5,1,1.7,1.9,1.6,1.6,1.5,1.4,1.6,1.6,1.5,1.5,1.4,1.5,1.2,1.3,1.4,1.3,1.5,1.3,1.3,1.3,1.6,1.9,1.4,1.6,1.4,1.5,1.4,4.7,4.5,4.9,4,4.6,4.5,4.7,3.3,4.6,3.9,3.5,4.2,4,4.7,3.6,4.4,4.5,4.1,4.5,3.9,4.8,4,4.9,4.7,4.3,4.4,4.8,5,4.5,3.5,3.8,3.7,3.9,5.1,4.5,4.5,4.7,4.4,4.1,4,4.4,4.6,4,3.3,4.2,4.2,4.2,4.3,3,4.1,6,5.1,5.9,5.6,5.8,6.6,4.5,6.3,5.8,6.1,5.1,5.3,5.5,5,5.1,5.3,5.5,6.7,6.9,5,5.7,4.9,6.7,4.9,5.7,6,4.8,4.9,5.6,5.8,6.1,6.4,5.6,5.1,5.6,6.1,5.6,5.5,4.8,5.4,5.6,5.1,5.1,5.9,5.7,5.2,5,5.2,5.4,5.1],[0.2,0.2,0.2,0.2,0.2,0.4,0.3,0.2,0.2,0.1,0.2,0.2,0.1,0.1,0.2,0.4,0.4,0.3,0.3,0.3,0.2,0.4,0.2,0.5,0.2,0.2,0.4,0.2,0.2,0.2,0.2,0.4,0.1,0.2,0.2,0.2,0.2,0.1,0.2,0.2,0.3,0.3,0.2,0.6,0.4,0.3,0.2,0.2,0.2,0.2,1.4,1.5,1.5,1.3,1.5,1.3,1.6,1,1.3,1.4,1,1.5,1,1.4,1.3,1.4,1.5,1,1.5,1.1,1.8,1.3,1.5,1.2,1.3,1.4,1.4,1.7,1.5,1,1.1,1,1.2,1.6,1.5,1.6,1.5,1.3,1.3,1.3,1.2,1.4,1.2,1,1.3,1.2,1.3,1.3,1.1,1.3,2.5,1.9,2.1,1.8,2.2,2.1,1.7,1.8,1.8,2.5,2,1.9,2.1,2,2.4,2.3,1.8,2.2,2.3,1.5,2.3,2,2,1.8,2.1,1.8,1.8,1.8,2.1,1.6,1.9,2,2.2,1.5,1.4,2.3,2.4,1.8,1.8,2.1,2.4,2.3,1.9,2.3,2.5,2.3,1.9,2,2.3,1.8],[\"setosa\",\"setosa\",\"setosa\",\"setosa\",\"setosa\",\"setosa\",\"setosa\",\"setosa\",\"setosa\",\"setosa\",\"setosa\",\"setosa\",\"setosa\",\"setosa\",\"setosa\",\"setosa\",\"setosa\",\"setosa\",\"setosa\",\"setosa\",\"setosa\",\"setosa\",\"setosa\",\"setosa\",\"setosa\",\"setosa\",\"setosa\",\"setosa\",\"setosa\",\"setosa\",\"setosa\",\"setosa\",\"setosa\",\"setosa\",\"setosa\",\"setosa\",\"setosa\",\"setosa\",\"setosa\",\"setosa\",\"setosa\",\"setosa\",\"setosa\",\"setosa\",\"setosa\",\"setosa\",\"setosa\",\"setosa\",\"setosa\",\"setosa\",\"versicolor\",\"versicolor\",\"versicolor\",\"versicolor\",\"versicolor\",\"versicolor\",\"versicolor\",\"versicolor\",\"versicolor\",\"versicolor\",\"versicolor\",\"versicolor\",\"versicolor\",\"versicolor\",\"versicolor\",\"versicolor\",\"versicolor\",\"versicolor\",\"versicolor\",\"versicolor\",\"versicolor\",\"versicolor\",\"versicolor\",\"versicolor\",\"versicolor\",\"versicolor\",\"versicolor\",\"versicolor\",\"versicolor\",\"versicolor\",\"versicolor\",\"versicolor\",\"versicolor\",\"versicolor\",\"versicolor\",\"versicolor\",\"versicolor\",\"versicolor\",\"versicolor\",\"versicolor\",\"versicolor\",\"versicolor\",\"versicolor\",\"versicolor\",\"versicolor\",\"versicolor\",\"versicolor\",\"versicolor\",\"versicolor\",\"versicolor\",\"virginica\",\"virginica\",\"virginica\",\"virginica\",\"virginica\",\"virginica\",\"virginica\",\"virginica\",\"virginica\",\"virginica\",\"virginica\",\"virginica\",\"virginica\",\"virginica\",\"virginica\",\"virginica\",\"virginica\",\"virginica\",\"virginica\",\"virginica\",\"virginica\",\"virginica\",\"virginica\",\"virginica\",\"virginica\",\"virginica\",\"virginica\",\"virginica\",\"virginica\",\"virginica\",\"virginica\",\"virginica\",\"virginica\",\"virginica\",\"virginica\",\"virginica\",\"virginica\",\"virginica\",\"virginica\",\"virginica\",\"virginica\",\"virginica\",\"virginica\",\"virginica\",\"virginica\",\"virginica\",\"virginica\",\"virginica\",\"virginica\",\"virginica\"]],\"container\":\"<table class=\\\"display\\\">\\n  <thead>\\n    <tr>\\n      <th> <\\/th>\\n      <th>Sepal.Length<\\/th>\\n      <th>Sepal.Width<\\/th>\\n      <th>Petal.Length<\\/th>\\n      <th>Petal.Width<\\/th>\\n      <th>Species<\\/th>\\n    <\\/tr>\\n  <\\/thead>\\n<\\/table>\",\"options\":{\"columnDefs\":[{\"targets\":1,\"render\":\"function(data, type, row, meta) {\\n    return type !== 'display' ? data : DTWidget.formatRound(data, 1, 3, \\\",\\\", \\\".\\\", null);\\n  }\"},{\"targets\":2,\"render\":\"function(data, type, row, meta) {\\n    return type !== 'display' ? data : DTWidget.formatRound(data, 1, 3, \\\",\\\", \\\".\\\", null);\\n  }\"},{\"targets\":3,\"render\":\"function(data, type, row, meta) {\\n    return type !== 'display' ? data : DTWidget.formatRound(data, 1, 3, \\\",\\\", \\\".\\\", null);\\n  }\"},{\"targets\":4,\"render\":\"function(data, type, row, meta) {\\n    return type !== 'display' ? data : DTWidget.formatRound(data, 1, 3, \\\",\\\", \\\".\\\", null);\\n  }\"},{\"className\":\"dt-right\",\"targets\":[1,2,3,4]},{\"orderable\":false,\"targets\":0}],\"order\":[],\"autoWidth\":false,\"orderClasses\":false,\"orderCellsTop\":true},\"selection\":{\"mode\":\"multiple\",\"selected\":null,\"target\":\"row\",\"selectable\":null}},\"evals\":[\"options.columnDefs.0.render\",\"options.columnDefs.1.render\",\"options.columnDefs.2.render\",\"options.columnDefs.3.render\"],\"jsHooks\":[]}</script>\n```\n:::\n:::\n\n\nIt's a pretty neat library, but I get overwhelmed with all of the options. \n  Especially since many of the options are set by passing HTML/CSS \n  and javascript code directly into the R code. Luckily there are some helpful\n  guides from [Rstudio](https://rstudio.github.io/DT/) and from the \n  [authors](https://datatables.net/)\n  \n\n## PDF Tables\n\nkableExtra and flextable can also make really nice PDF tables as well. For small\n  tables I lean towards flextable just because I think it looks \"better\" right \n  away. For longer tables I lean towards kableExtra because of some of the row\n  highlighting and spacing it does easily. Let's see some examples\n  \n### kableExtra\n\n::: {.cell}\n\n```{.r .cell-code}\niris |> \n  group_by(Species) |> \n  summarise(across(.fns=list(mean=mean, sd=sd))) |> \n  kableExtra::kbl(\n    booktabs = T,\n    col.names = c(\"Species\", rep(c(\"Mean\", \"SD\"), 4)),\n    digits=1\n  ) |> \n  kableExtra::add_header_above(\n    c(\" \", \n      \"Sepal Length\"=2, \n      \"Sepal Width\"=2,\n      \"Petal Length\"=2,\n      \"Petal Width\"=2), \n    align = \"c\"\n  ) |> \n  kableExtra::kable_classic_2() \n```\n:::\n\n\n\n![kableExtra PDF Table](kableExtra-small-pdf.PNG)\n\nI ran the above code in a PDF format quarto document with `mainfont: Cambria`. \n  I really don't care for the default LaTeX font.\n  Using the various styling functions in kableExtra speeds up the layout process. \n  I tend not to use them for HTML tables though, just `kable_styling()`.\n  \nFor longer tables in a PDF document I make use of the `latex_options` flag in \n  `kable_styling()`:\n  \n\n::: {.cell tbl-cap='Iris Data (long) - kableExtra'}\n\n```{.r .cell-code}\niris |> \n  head(20) |> \n  kableExtra::kbl(\n    booktabs = T,\n    col.names = c(\"Sepal Length\", \"Sepal Width\", \n                  \"Petal Length\", \"Petal Width\",\n                  \"Species\"),\n    digits=1\n  ) |> \n  kableExtra::kable_classic_2() |> \n  kableExtra::kable_styling(latex_options = \"striped\")\n```\n:::\n\n\n![kableExtra Long PDF Table](kableExtra-long-pdf.PNG)\n  \nThe default of adding a little extra vertical padding every 5 lines, along\n  with the `striped` option helps readability. \n\n\n### Flextable\n\nFor this flextable example, I used the exact same code as the previous HTML\n  example, but ran it in a PDF format quarto document. The library really lives\n  up to it's name!\n\n![flextable PDF Table](flextable-small-pdf.PNG)\n\nLonger flextables are where I run into issues though:\n\n::: {.cell tbl-cap='Iris Data (long) - flextable'}\n\n```{.r .cell-code}\nevens <- function(x) subset(x, x %% 2 == 0)\nfives <- function(x) subset(x, x %% 5 == 0)\n\nirisSubset <- iris |> \n  head(20) \n\nirisSubset |> \n  flextable::flextable() |> \n  flextable::set_header_labels(\n    Sepal.Length=\"Sepal Length\", \n    Sepal.Width=\"Sepal Width\", \n    Petal.Length=\"Petal Length\", \n    Petal.Width=\"Petal Width\") |> \n  flextable::align(j=5, align=\"center\", part=\"all\") |> \n  flextable::bg(i=evens(c(1:length(irisSubset[,1]))), bg=\"#eeeeee\") |> \n  flextable::padding(i=fives(c(1:length(irisSubset[,1]))), padding.bottom = 20) |> \n  flextable::autofit()\n```\n:::\n\n\n![flextable Long PDF Table](flextable-long-pdf.PNG)\n\nThe color and padding have to be manually defined which adds to code length and\n  complexity. That's not always a bad thing, but unfortunately not all of this code\n  works in both HTML and PDF. `flextable::padding()` is the main issue. \n  Theoretically you could add blank rows or something but that just further clutters\n  up the code when you could just use kableExtra. In general, I find that simpler\n  is better when it come to LaTeX and flextable. \n  \n## Microsoft output\n\nMost of the table libraries are focused on HTML, so outputting to Word usually \n  involves using `webshot` to save a png and insert it into the document, or \n  tossing out most of the formatting with a markdown table. \n  \n### kableExtra\n\nIf you use the `prefer-html: true` option in the YAML header, kableExtra can \n output simple markdown tables into a document:\n  \n![kableExtra Small Docx Table](kableExtra-small-docx.PNG)\n\n![kableExtra Long Docx Table](kableExtra-long-docx.PNG)\n\nBut notice that they lose most of the formatting options that were applied. \n  Also notice that while there is a caption, Word didn't recognize it as the \n  table caption so there is no numbering or document linking, and that's even\n  with using Quarto's `tbl-cap` chunk option!\n\n\n### flextable\n\nFlextable was designed to generate real MS Office tables though:\n\n![flextable Small Docx Table](flextable-small-docx.PNG)\n\n![flextable Long Docx Table](flextable-long-docx.PNG)\n\nThese tables look pretty good (if nothing else they're drawn exactly as I told \n  flextable). The `padding` option also works in Word documents. \n  As before, the flextable\n output all uses the same code for HTML, PDF, and Docx report formats.\n \n## Closing thoughts\n\nIn general, when I am making tables in an HTML document I'll go with kableExtra\n  because it very quickly gets me on the right track. However, there are many, \n  many other options. When I am working with PDF documents I'll use flextable for\n  the simple stuff and kableExtra when I need better control over the LaTeX code\n  being generated. When I am making Word documents, there's really no better choice\n  than flextable. \n  \n### Quarto/RMarkdown Tip\n\nI often create HTML and PDF/Docx reports for the same data. HTML is great for \n  opening on a screen and interacting with the report, while PDF/Word can be\n  more easily emailed, printed, etc. To facilitate my above mentioned table \n  choices, I use the following code early in the document:\n  \n\n::: {.cell}\n\n```{.r .cell-code}\nis_html <- knitr::is_html_output()\n```\n:::\n\n\nWhen the report is being compiled, the variable `is_html` will be `TRUE` for \n  HTML documents and `FALSE` for all others. Then I can define functions like:\n\n::: {.panel-tabset}\n\n#### Small Table\n\n::: {.cell tbl-cap='Iris Data - kableExtra or flextable'}\n\n```{.r .cell-code}\nirisSumm <- iris |> \n  group_by(Species) |> \n  summarise(across(.fns=list(mean=mean, sd=sd))) \n\nif(is_html){\n  \n  irisSumm |> \n    kableExtra::kbl(\n      col.names = c(\"Species\", rep(c(\"Mean\", \"SD\"), 4)),\n      digits=1\n    ) |> \n    kableExtra::add_header_above(\n      c(\" \", \n        \"Sepal Length\"=2, \n        \"Sepal Width\"=2,\n        \"Petal Length\"=2,\n        \"Petal Width\"=2), \n      align = \"c\"\n    ) |> \n    kableExtra::kable_styling(\n      bootstrap_options = c(\"hover\", \"responsive\")\n    )\n  \n} else {\n  \n  irisSumm |> \n    flextable::flextable() |> \n    flextable::set_header_labels(\n      Sepal.Length_mean = \"Mean\",\n      Sepal.Length_sd = \"SD\",\n      Sepal.Width_mean = \"Mean\",\n      Sepal.Width_sd = \"SD\",\n      Petal.Length_mean = \"Mean\",\n      Petal.Length_sd = \"SD\",\n      Petal.Width_mean = \"Mean\",\n      Petal.Width_sd = \"SD\"\n    ) |> \n    flextable::add_header_row(\n      values=c(\"\", \"Sepal Length\", \"Sepal Width\", \"Petal Length\", \"Petal Width\"),\n      colwidths = c(1, 2, 2, 2, 2)\n    ) |> \n    flextable::colformat_double(j=2:9, digits=1) |> \n    flextable::align(i=1, j=2:9, align=\"center\", part=\"header\")\n  \n}\n```\n:::\n\n  \n#### Long Table\n\n::: {.cell tbl-cap='Iris Data (long) - kableExtra or Flextable'}\n\n```{.r .cell-code}\nevens <- function(x) subset(x, x %% 2 == 0)\nfives <- function(x) subset(x, x %% 5 == 0)\n\nirisSubset <- iris |> \n  head(20)  \n\nif(is_html){\n  \n  irisSubset |> \n    kableExtra::kbl(\n      booktabs = T,\n      col.names = c(\"Sepal Length\", \"Sepal Width\", \n                    \"Petal Length\", \"Petal Width\",\n                    \"Species\"),\n      digits=1\n    ) |> \n    kableExtra::kable_styling(bootstrap_options = c(\"hover\", \"responsive\", \"condensed\"))\n  \n} else{\n\nirisSubset |> \n  flextable::flextable() |> \n  flextable::set_header_labels(\n    Sepal.Length=\"Sepal Length\", \n    Sepal.Width=\"Sepal Width\", \n    Petal.Length=\"Petal Length\", \n    Petal.Width=\"Petal Width\") |> \n  flextable::align(j=5, align=\"center\", part=\"all\") |> \n  flextable::bg(i=evens(c(1:length(irisSubset[,1]))), bg=\"#eeeeee\") |> \n  flextable::padding(i=fives(c(1:length(irisSubset[,1]))), padding.bottom = 20) |> \n  flextable::autofit()\n\n}\n```\n:::\n\n\n\n:::\n\n",
    "supporting": [],
    "filters": [
      "rmarkdown/pagebreak.lua"
    ],
    "includes": {
      "include-in-header": [
        "<script src=\"../../site_libs/kePrint-0.0.1/kePrint.js\"></script>\r\n<link href=\"../../site_libs/lightable-0.0.1/lightable.css\" rel=\"stylesheet\" />\r\n<link href=\"../../site_libs/tabwid-1.1.2/tabwid.css\" rel=\"stylesheet\" />\r\n<script src=\"../../site_libs/htmlwidgets-1.6.1/htmlwidgets.js\"></script>\r\n<link href=\"../../site_libs/datatables-css-0.0.0/datatables-crosstalk.css\" rel=\"stylesheet\" />\r\n<script src=\"../../site_libs/datatables-binding-0.27/datatables.js\"></script>\r\n<script src=\"../../site_libs/jquery-3.6.0/jquery-3.6.0.min.js\"></script>\r\n<link href=\"../../site_libs/dt-core-1.12.1/css/jquery.dataTables.min.css\" rel=\"stylesheet\" />\r\n<link href=\"../../site_libs/dt-core-1.12.1/css/jquery.dataTables.extra.css\" rel=\"stylesheet\" />\r\n<script src=\"../../site_libs/dt-core-1.12.1/js/jquery.dataTables.min.js\"></script>\r\n<link href=\"../../site_libs/nouislider-7.0.10/jquery.nouislider.min.css\" rel=\"stylesheet\" />\r\n<script src=\"../../site_libs/nouislider-7.0.10/jquery.nouislider.min.js\"></script>\r\n<link href=\"../../site_libs/selectize-0.12.0/selectize.bootstrap3.css\" rel=\"stylesheet\" />\r\n<script src=\"../../site_libs/selectize-0.12.0/selectize.min.js\"></script>\r\n<link href=\"../../site_libs/crosstalk-1.2.0/css/crosstalk.min.css\" rel=\"stylesheet\" />\r\n<script src=\"../../site_libs/crosstalk-1.2.0/js/crosstalk.min.js\"></script>\r\n"
      ]
    },
    "engineDependencies": {},
    "preserve": {},
    "postProcess": true
  }
}